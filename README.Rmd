---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# FunBootBand

<!-- badges: start -->

<!-- badges: end -->

Compute statistical bands from curve data using a functional approach and bootstrapping. 

At its core, this is an implementation of the method developed by Sutherland et al. (1988) and Olshen et al. (1989), described in detail in Lenhoff et al. (1999). The method was originally written as a MATLAB program by Doris Oriwol and later translated into R and extended with an approach to handle hierarchical data (see also [https://github.com/koda86/floa](https://github.com/koda86/floa)).

More details can be found in this publication (and the vignette):

Koska, D., Oriwol, D., & Maiwald, C. (2023). Comparison of statistical models for characterizing continuous differences between two biomechanical measurement systems. Journal of Biomechanics, J. Biomech. 149, https://doi.org/10.1016/j.jbiomech.2023.111506.

## Citation

<!-- IMHO, the following statement makes a great point: -->
<!-- <small> "Every great open source math library is built on the ashes of someone’s academic career" – https://njt-rse-unsw.netlify.app/#24 </small> -->

Please cite the package via `citation("FunBootBand")`.

## Issues and contributing

In case you find a bug or run into other problems, please look for the "Issues" tab. Feedback of any kind is welcome.

## Installation

You can install the development version of FunBootBand from [GitHub](https://github.com/koda86/FunBootBand) with:

``` r
# install.packages("devtools")
devtools::install_github("koda86/FunBootBand")
```

## Example

Here's how to use the `band()` function with the built-in data set.

```{r example}
library(FunBootBand)

# In the example, `B` is set to only 5 to guarantee a fast calculation.
# In reality, this value would be too low (package default: 400).
prediction.band <- band(data,
                        type = "prediction",
                        B = 5,
                        alpha = 0.05,
                        iid = TRUE)

# Function output:
rownames(prediction.band)
str(prediction.band)
```

You may, i.e., print the calculated limits alongside the original curves.

```{r results='hide'}
plot(data[, 1], type = "l", ylim = c(-3, 3), ylab = "Amplitude")
apply(data, 2, function(x) lines(x))
apply(prediction.band, 1, function(x) lines(x, col = "red", lwd = 4))
```

<!-- What is special about using `README.Rmd` instead of just `README.md`? You can include R chunks like so: -->

<!-- ```{r cars} -->
<!-- summary(cars) -->
<!-- ``` -->

<!-- You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this. You could also use GitHub Actions to re-render `README.Rmd` every time you push. An example workflow can be found here: <https://github.com/r-lib/actions/tree/v1/examples>. -->

<!-- You can also embed plots, for example: -->

<!-- ```{r pressure, echo = FALSE} -->
<!-- plot(pressure) -->
<!-- ``` -->

<!-- In that case, don't forget to commit and push the resulting figure files, so they display on GitHub and CRAN. -->

## Licence

LGPL (>= 3)

## References

* Lenhoff, M.W., Santner, T.J., Otis, J.C., Peterson, M.G., Williams, B.J., Backus, S.I., 1999. Bootstrap prediction and confidence bands: a superior statistical method for analysis of gait data. Gait Posture 9 (1), 10–17. http://dx.doi.org/10.1016/s0966-
6362(98)00043-5.

* Olshen, R.A., Biden, E.N., Wyatt, M.P., Sutherland, D.H., 1989. Gait analysis and the bootstrap. Ann. Statist. 17 (4), http://dx.doi.org/10.1214/aos/1176347372.

* Sutherland, D., Olshen, R., Biden, E., Wyatt, M., 1988. Development of Mature Walking. Mac Keith Press.


